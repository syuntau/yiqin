<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
	"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
	"http://struts.apache.org/dtds/struts-2.3.dtd">

<struts>

	<include file="struts-default.xml" />
	<package name="shop" extends="struts-default">
		<result-types>
			<result-type name="tiles" class="org.apache.struts2.views.tiles.TilesResult" />
		</result-types>
		
		<interceptors>
			<interceptor name="setNav" class="com.yiqin.shop.interceptor.ShopNavInterceptor" />
			<!-- 自定义拦截器：用来拦截用户没有登录的操作 -->
			<interceptor name="notLoginInterceptor" class="com.yiqin.shop.interceptor.NotLoginInterceptor"></interceptor>
			<interceptor-stack name="myStack">
				<interceptor-ref name="notLoginInterceptor"></interceptor-ref>
				<interceptor-ref name="defaultStack"></interceptor-ref>
			</interceptor-stack>
		</interceptors>
		<default-interceptor-ref name="myStack"></default-interceptor-ref>

		<!-- 定义一个全局的结果login-->
		<global-results>
			<result name="login">/shop/jsp/common/cenJump.jsp</result>
		</global-results>

		<action name="index" class="com.yiqin.shop.action.IndexAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<param name="home">top_home</param>
			<result type="chain">dispatcher</result>
		</action>

		<action name="login" class="com.yiqin.shop.action.LoginAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result name="login" type="tiles">shop.login</result>
			<result name="success" type="chain">index</result>
		</action>
		
		<action name="logout" class="com.yiqin.shop.action.LogoutAction">
			<result name="login" type="tiles">shop.login</result>
		</action>
		
		<action name="register" class="com.yiqin.shop.action.RegisteredUserAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
		</action>
		
		<action name="modifyUserInfo" class="com.yiqin.shop.action.ModifyUserInfoAction"></action>
		
		<action name="addProductToCart" class="com.yiqin.shop.action.AddProductToCartAction"></action>
		
		<action name="findCartInfo" class="com.yiqin.shop.action.FindCartInfoAction"></action>
		
		<action name="findCartNum" class="com.yiqin.shop.action.FindCartNumberAction"></action>
		
		<action name="findProductInfo" class="com.yiqin.shop.action.FindProductInfoAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
		</action>
		
		<action name="findCategory" class="com.yiqin.shop.action.FindCategoryInfoAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
		</action>
		
		<action name="deleteCartProduct" class="com.yiqin.shop.action.DeleteCartProductAction"></action>
		
		<action name="deleteUserAddress" class="com.yiqin.shop.action.DeleteUserAddressAction"></action>
		
		<action name="findUserConf" class="com.yiqin.shop.action.FindUserConfAction"></action>
		
		<action name="saveOrUpdateAddress" class="com.yiqin.shop.action.ModifyUserAddressAction"></action>
		
		<action name="updateCartProductsNum" class="com.yiqin.shop.action.UpdateCartProductsNumAction"></action>
		
		<action name="toSettlementOrder" class="com.yiqin.shop.action.ToSettlementOrderAction">
			<result name="success" type="tiles">shop.order</result>
		</action>
		
		<action name="submitOrder" class="com.yiqin.shop.action.SubmitOrderAction">
			<result name="success" type="tiles">shop.center.order</result>
		</action>
		
		<action name="toCategorySearch" class="com.yiqin.shop.action.ToCategorySearchAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result name="success" type="tiles">shop.search</result>
		</action>
		
		<action name="toProductDetails" class="com.yiqin.shop.action.ToProductDetailsAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
			<result name="success" type="tiles">shop.details</result>
		</action>
		
		<action name="findProductsByCategory" class="com.yiqin.shop.action.FindProductsByCategoryAction">
			<interceptor-ref name="defaultStack"></interceptor-ref>
		</action>

		<action name="dispatcher" class="com.yiqin.shop.action.ShopNavDispatcherAction">
			<interceptor-ref name="setNav"></interceptor-ref>
			<result name="top_account" type="tiles">shop.index</result>
			<result name="top_quick_shopping" type="tiles">shop.index</result>
			<result name="top_cart" type="tiles">shop.cart</result>
			<result name="top_order" type="tiles">shop.center.order</result>
			<result name="top_login" type="tiles">shop.login</result>
			<result name="top_home" type="tiles">shop.index</result>
			<result name="top_logout" type="chain">logout</result>
		</action>
	</package>

</struts>
